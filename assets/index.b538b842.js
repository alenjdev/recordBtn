var l=Object.defineProperty;var u=(o,e,t)=>e in o?l(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t;var c=(o,e,t)=>(u(o,typeof e!="symbol"?e+"":e,t),t);import{j as f,r as d,A as m,B as p,a as h,F as g,R as v,b as y,c as b}from"./vendor.f002f889.js";const D=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerpolicy&&(i.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?i.credentials="include":s.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}};D();const n=f.exports.jsx;class R extends d.exports.Component{constructor(e){super(e);c(this,"receiveModuleData",async e=>{const{isRecording:t}=this.state,r=S(e);r!==void 0&&typeof r!="string"&&(r.values[0]===void 0||r.values.length===0||t!==r.values[0]&&this.setState({isRecording:r.values[0],disable:!1}))});c(this,"issueCommand",async()=>{const{device:e}=this.props,{isRecording:t}=this.state;!e||(e.sendCommand("switch_polygon_record",t?"STOP":"START"),this.setState({disable:!0}),setTimeout(()=>{this.setState({disable:!1})},2e4))});this.state={isRecording:!1,disable:!1}}componentDidMount(){m.addModuleDataListener(this.receiveModuleData)}render(){const{disable:e,isRecording:t}=this.state;return n("div",{children:n(p,{disabled:e,onClick:this.issueCommand,type:"primary",size:"large",children:t?"STOP Polygon record":"START Polygon record"})})}}function S(o){const e=Object.values(o.streams);if(e.length===0)return"No streams.";const t=e[0];if(t===void 0)return"No stream.";if(t.loading)return;if(t.tooMuchData)return"Too much data.";if(t.data.length===0)return"No data.";const r=t.data[0].points.at(-1);return r?r[1]:"No datapoints."}const A=()=>{const[o,e]=d.exports.useState();d.exports.useEffect(()=>{t()},[]);const t=async()=>{if(await h.waitTilAuthenticated()){const r=await g.getCurrentDevice();e(r)}};return n("div",{className:"App",children:n(R,{device:o})})};v.render(n(y,{type:"module",children:n(b.StrictMode,{children:n(A,{})})}),document.getElementById("root"));
